<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Negotiation Help Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .ai-output {
            height: 450px;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background: #fafafa;
        }
    </style>
</head>

<body class="bg-slate-50 min-h-screen flex flex-col justify-center p-4 bg-[radial-gradient(#008000_1px,transparent_1px)] [background-size:16px_16px]" style="background-color:#C9E4DE">
    <nav class="fixed top-1 left-1/2 -translate-x-1/2 w-full flex items-center justify-between px-6 py-4 glass border border-white shadow-lg rounded-2xl z-50">
        <div class="text-xl font-bold">
            Negotiation Help Center
        </div>

        <div class="flex gap-6 text-sm font-semibold">
            <a href="/" class="hover:underline">Home</a>
            <a href="/about" class="hover:underline">About</a>
        </div>
    </nav>

    <div class="w-full max-w-md" style="margin-right: auto; margin-left: auto;">
        <div class="text-center mb-8">
            <h1 class="text-4xl text-center font-extrabold tracking-tight italic">
                Wage<span class="text-[#FBEC5D]">Gap</span><br>
                Help<span class="text-[#FBEC5D]">Center</span>
            </h1>
        </div>

        <div class="glass border border-white shadow-2xl rounded-[2.5rem] p-10 ai-output" id="ai-output">
            <p class="font-semibold mb-4">
                Before we begin, what occupation do you currently work in?
            </p>

            <input
                id="occupation-input"
                type="text"
                placeholder="Example: Software Engineer, Nurse, Teacher"
                class="w-full border border-gray-300 rounded-lg p-2 mb-4"
            />

            <button
                onclick="submitOccupation()"
                class="w-full bg-[#FBEC5D] text-white font-bold py-2 rounded-xl hover:bg-red-950 transition-all"
            >
                Continue
            </button>
        </div>

        <!-- Action Buttons -->
        <div class="mt-6 flex gap-4 justify-center">
            <button
                onclick="generateNewResponse()"
                class="bg-[#FBEC5D] text-white font-bold py-3 px-6 rounded-xl hover:bg-red-950 transition-all"
            >
                New Response
            </button>

            <a href="/"
               class="bg-[#FBEC5D] text-white font-bold py-3 px-6 rounded-xl hover:bg-red-950 transition-all">
               New Search
            </a>
        </div>
    </div>

    <script>
        let savedOccupation = "";

        function buildPrompt(occupation) {
            return `
You are a career and wage equity assistant helping women who may be underpaid.
The user works in the following occupation: ${occupation}.

Your task:
Explain how women are typically underpaid in this occupation nationally and locally.
Provide practical advice to help women advance their careers and negotiate fair pay.

Use guidance from these resources:
https://leanin.org/negotiation
https://www.comerica.com/insights/business-management/assorted-business/salary-negotiation-tactics-every-woman-should-know.html
https://hightoweradvisors.com/blogs/well-th-blog/how-to-negotiate-a-fair-and-equal-salary
https://www.stkate.edu/academics/women-in-leadership-degrees/women-negotiating-salary
https://powertofly.com/up/salary-negotiation-women

Rules:
Do not ask the user questions.
Do not change topics.
Write short, clear sentences.
No symbols.
No asterisks.
No Text Formatting
Max 300 words.
Use headers for sections.
`;
        }

        async function submitOccupation() {
            const occupation = document.getElementById("occupation-input").value.trim();
            if (!occupation) return;

            savedOccupation = occupation;
            await generateResponse();
        }

        async function generateNewResponse() {
            if (!savedOccupation) return;
            await generateResponse();
        }

        async function generateResponse() {
            const output = document.getElementById("ai-output");
            output.innerText = "Generating personalized advice...";

            try {
                const res = await fetch("/ask", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ prompt: buildPrompt(savedOccupation) })
                });

                const data = await res.json();
                output.innerText = data.response;
            } catch (err) {
                output.innerText = "Sorry, we could not generate advice at this time.";
                console.error(err);
            }
        }
    </script>
</body>
</html>
